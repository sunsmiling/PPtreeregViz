<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="PPtreeregViz">
<title>Get started with `PPtreeregViz` • PPtreeregViz</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get started with `PPtreeregViz`">
<meta property="og:description" content="PPtreeregViz">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PPtreeregViz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/PPtreeregViz.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sunsmiling/PPtreeregViz/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get started with `PPtreeregViz`</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sunsmiling/PPtreeregViz/blob/HEAD/vignettes/PPtreeregViz.Rmd" class="external-link"><code>vignettes/PPtreeregViz.Rmd</code></a></small>
      <div class="d-none name"><code>PPtreeregViz.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>include <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sunsmiling/PPtreeregViz" class="external-link">PPtreeregViz</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction-of-pptreeregviz">Introduction of PPtreeregViz<a class="anchor" aria-label="anchor" href="#introduction-of-pptreeregviz"></a>
</h2>
<!-- badges: start -->
<!-- badges: end -->
<p>This package was developed to visualize the Projection Pursuit
Regression Tree model
<a href="https://www.mdpi.com/2076-3417/11/21/9885/pdf" class="external-link"></a> and add
explanatory possibilities of the model using techniques. Since
projection pursuit regression tree is based on tree method and grows
using projection of input features, the model has excellent
interpretability itself. By visualizing each node of this model, global
analysis of the model is possible. (This method is model-specific
because it can only be used in the model.) Global interpretation using
this method is possible, but it is difficult to interpret one
observation because it goes through several projections. To overcome
this, the developed techniques were slightly modified to fit the
structure of model. Using these visualization methods, it is possible to
figure out how and what features have affected the model’s prediction.
Through these processes, we can determine whether the model is
trustworthy or not.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><a href="https://github.com/sunsmiling/PPtreeregViz" class="external-link"><img src="figures/logo.png" align="right" height="138.5"></a></p>
<p>You can install the released version of from CRAN with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"PPtreeregViz"</span><span class="op">)</span></span></code></pre></div>
<p>And the development version from GitHub with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"sunsmiling/PPtreeregViz"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-data">Example Data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h2>
<p>As an example, Boston house price data from the MASS library was
used. In the first part, we will talk about visualizing model itself.
Next, we will see an example of explaining model by applying
techniques.</p>
<div class="section level3">
<h3 id="boston-data">Boston Data<a class="anchor" aria-label="anchor" href="#boston-data"></a>
</h3>
<p>The Boston data were divided into a train data set and a test data
set at a ratio of 7:3. In particular, the first observation in the test
data set was specifically selected as “sample_one”.</p>
</div>
</div>
<div class="section level2">
<h2 id="build-model-plot-model-itself">Build Model &amp; Plot Model itself<a class="anchor" aria-label="anchor" href="#build-model-plot-model-itself"></a>
</h2>
<p>Create a model with Depth as 2 for ease of visualization and
interpretation.</p>
<p>Through <code>pp_ggparty</code>, marginal predicted values and actual
values are drawn according to independent variables for each final node.
In the group with the lower 25% of house prices, (lower status of the
population (percent)) had a wide range from 10 to 30, but in the group
with the top 25%, had only values less than 15.</p>
<div class="section level3">
<h3 id="variable-importance-plot">variable importance plot<a class="anchor" aria-label="anchor" href="#variable-importance-plot"></a>
</h3>
<p>By using the combination of the regression coefficient values of the
projection values at each split node, the importance of the variables
for which the model was built can be calculated.
<code>PPimportance</code> calculate split node’s coefficients and can be
drawn for each final leaf. The blue bar represents the positive slope
(effect), and the red bar represents the negative slope.</p>
<p>Variables are sorted according to the overall size of each bar, so
you can know the variables that are considered important for each final
node sequentially.</p>
<p>If you use some arguments such as <code>marginal = TRUE</code> and
<code>num_var</code>, you can see the desired number of marginal
variable importance of the whole rather than each final leaf.</p>
</div>
<div class="section level3">
<h3 id="node-visualization">Node visualization<a class="anchor" aria-label="anchor" href="#node-visualization"></a>
</h3>
<p><code>PPregNodeViz</code> can visualize how train data is fitted for
each node. When the node.id is 4 (i.e. first final node), the result of
fitted data is displayed in black color. In order to improve accuracy,
can choose the final rule from 1 to 5, whether to use a single value or
a linear combination of independent variables.</p>
<p>4th final leaf’s node id is 7.</p>
</div>
<div class="section level3">
<h3 id="variable-visualization">Variable visualization<a class="anchor" aria-label="anchor" href="#variable-visualization"></a>
</h3>
<p>Using <code>PPregvarViz</code> shows results similar to partial
dependent plots of how independent variable affects the prediction of Y
in actual data. If the argument <code>Indiv=TRUE</code>, the picture is
drawn by dividing the grid for each final node.</p>
</div>
</div>
<div class="section level2">
<h2 id="using-method">Using method<a class="anchor" aria-label="anchor" href="#using-method"></a>
</h2>
<div class="section level3">
<h3 id="calculate-shap-for-method">Calculate SHAP for method<a class="anchor" aria-label="anchor" href="#calculate-shap-for-method"></a>
</h3>
<p>So far, we have only seen the global movement of the model itself.
From now on, we will proceed with model analysis using SHAP values.
Using the SHAP value, you can see locally how one sample data moves in
the model. In order to calculate the SHAP value more faster, the method
for calculating the kernel shap of the package was slightly modified and
used.</p>
<p>Since the <code>empirical</code> method, which is a more accurate
calculation method, takes more time to calculate, a <code>simple</code>
calculation method, which is an estimate of this value, was used.</p>
<p>Although the difference in calculation speed between and is quite
large, it can be seen that the results are similar.</p>
</div>
<div class="section level3">
<h3 id="decision-plot">Decision plot<a class="anchor" aria-label="anchor" href="#decision-plot"></a>
</h3>
<p> creates a tree based on the range of y values. Therefore, when
calculating the contributions of features of one observation, it is
natural that different values are calculated for each final leaf.
Compared with the data with y value in the lower 25% (first final leaf),
the effect of of [<code>sample_one</code>] was very large. On the other
hand, it can be seen that the influence of rm (average number of rooms
per dwelling) is very large in data with upper 25% large y value (4th
final leaf). How each feature affects y hat in one observation can be
drawn in two ways. <code>decisionplot</code> and
<code>waterfallplot</code>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Eun-Kyung Lee, HyunSun Cho.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
